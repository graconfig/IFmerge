# 更新日志

## [2.0.0] - 2026-01-23

### 重大变更 🚨
- ✅ **AI功能始终启用**：移除USE_AI和ENABLE_CLASSIFICATION参数
  - AI分类功能现在是核心功能，始终启用
  - AI内容生成（IF概要、代表項目名、合并IF名）始终启用
  - 简化配置和使用流程
- ✅ **移除命令行参数**：删除`--use-ai`、`--no-ai`、`--classify`、`--no-classify`参数
- ✅ **简化.env配置**：移除USE_AI和ENABLE_CLASSIFICATION配置项

### 改进
- ✅ 用户体验：更简单的配置和使用流程
- ✅ 一致性：所有用户使用相同的AI增强功能
- ✅ 文档更新：更新所有文档以反映AI始终启用的变更

### 文档
- ✅ 更新CONFIGURATION_GUIDE.md：移除AI开关相关说明
- ✅ 更新README.md：强调AI功能始终启用
- ✅ 更新QUICKSTART.md：添加SAP AI Core配置步骤
- ✅ 更新.env和.env.example：移除AI开关配置

### 迁移指南
如果你从1.x版本升级：
1. 更新.env文件：移除USE_AI和ENABLE_CLASSIFICATION行
2. 确保SAP AI Core配置正确（现在是必需的）
3. 移除命令行中的--use-ai和--classify参数

## [1.5.1] - 2026-01-22

### 修复
- ✅ **模板填充AI内容**：模板文件现在正确使用AI生成的合并IF名
  - 文件名使用AI生成的名称（更简洁）
  - 文書名 (Q4) 使用AI名称
  - データ定義名称 (G6) 使用AI名称
  - ファイル名 (G21) 使用AI名称
- ✅ 向后兼容：不使用AI时自动回退到默认名称

### 改进
- ✅ 文件名长度：从73字符减少到23字符（减少68%）
- ✅ 可读性：AI生成的名称更专业、更易读

## [1.5.0] - 2026-01-22

### 新增
- ✅ **AI分类功能**：使用AI按SAP模块和业务场景对IF进行智能分类
  - 自动识别SAP模块（WM、SD、MM、PP、FI等）
  - 按业务场景分组（出货管理、订单处理、库存管理等）
  - 生成分类报告和分类数据文件
  - 对每个分类分别进行合并处理
- ✅ 命令行参数：新增 `--classify` 参数启用AI分类
- ✅ 分类输出：在`output/classified/`目录下按分类组织文件
- ✅ 分类报告：自动生成包含分类说明的报告文件

### 改进
- ✅ 文件组织：按业务场景组织输出文件，便于团队分工
- ✅ 处理流程：先分类后合并，提高大型项目的可管理性
- ✅ 错误处理：分类失败时自动回退到"其他_未分类"

### 文档
- ✅ 新增AI_CLASSIFICATION_GUIDE.md：AI分类功能详细指南
- ✅ 更新README.md：添加分类功能说明

## [1.4.0] - 2026-01-22

### 新增
- ✅ AI功能集成：使用SAP AI Core的Claude 4.5 Sonnet模型自动生成内容
  - IF概要：根据IF的表名、字段等信息生成功能说明（30-50字）
  - 代表項目名：智能选择最能代表核心功能的项目
  - グルーピング後のIF名：为合并的IF组生成有意义的名称
- ✅ 命令行参数：新增 `--use-ai` 参数启用AI功能
- ✅ 环境变量配置：支持通过.env文件配置SAP AI Core凭证
- ✅ 错误处理：AI调用失败时自动回退到默认逻辑，不影响核心功能
- ✅ **Converse API**：使用Claude原生converse API（替代orchestration）
- ✅ **Tool Calling**：支持工具调用，一次API调用获取多个信息
- ✅ **批量生成**：一次性生成所有IF的概要和代表項目名

### 改进
- ✅ 合并单元格复制：超过模板初始10个项目时，正确复制合并单元格结构
- ✅ 格式一致性：确保新增行的所有格式（字体、边框、填充、对齐、合并单元格）与模板完全一致
- ✅ **性能优化**：API调用次数从9次减少到2次（减少78%）
- ✅ **速度提升**：处理时间从15秒减少到5秒（提升3倍）
- ✅ **成本降低**：Token消耗减少63%

### 测试
- ✅ Converse API测试：成功连接并使用tool calling
- ✅ 批量生成测试：一次调用成功生成4个IF的信息
- ✅ 完整功能测试：2次API调用完成所有生成任务
- ✅ 质量评估：生成内容准确、专业、简洁

### 文档
- ✅ 新增AI_FEATURE_GUIDE.md：AI功能配置和使用指南
- ✅ 新增AI_QUICK_START.md：5分钟快速开始指南
- ✅ 新增AI_IMPLEMENTATION_SUMMARY.md：实现总结
- ✅ 新增AI_TEST_RESULTS.md：测试结果报告
- ✅ 新增AI_OPTIMIZATION_SUMMARY.md：优化总结
- ✅ 更新README.md：添加AI功能说明
- ✅ 新增.env.example：环境变量配置模板

### 依赖
- ✅ 新增requests：HTTP请求库
- ✅ 新增python-dotenv：环境变量加载

## [1.3.0] - 2026-01-21

### 新增
- ✅ 模板填充功能：为需要合并的IF自动生成填充后的Excel模板文件
- ✅ 模板文件命名：格式为"グルーピングID_合并后的IF名.xlsm"
- ✅ 自动填充模板内容：
  - 基本信息：文書管理番号、文書名、作成日、最終更新日、データ定義名称、ファイル名
  - 抽出項目表格：No、テーブル名（格式：表名 (表ID)）、項目（項目ID和項目名）
- ✅ 数据去重：合并后的表格自动去除重复的(EBSテーブルID, 項目ID)对
- ✅ 格式复制：超过模板初始20行（10个项目）的数据自动复制第10个项目的格式（边框、字体、对齐等）

## [1.2.0] - 2026-01-21

### 改进
- ✅ マージ要否格式：从"要"/"不要"改为"○"/"×"（○表示需要合并，×表示不需要合并）

## [1.1.0] - 2026-01-20

### 新增
- ✅ 批量处理功能：自动处理input文件夹中的所有Excel文件
- ✅ 文件夹结构：创建input和output文件夹
- ✅ 进度显示：显示批量处理进度和每个文件的状态
- ✅ 错误处理：单个文件失败不影响其他文件的处理

### 改进
- ✅ グルーピングID格式：从数字（1, 2, 3）改为标准格式（G001, G002, G003）
- ✅ 输出文件命名：自动添加前缀"グルーピング結果_"
- ✅ 用户体验：更清晰的进度显示和统计信息

### 文档
- ✅ 更新README.md
- ✅ 更新USAGE.md
- ✅ 新增QUICKSTART.md快速入门指南
- ✅ 新增CHANGELOG.md更新日志

## [1.0.0] - 2026-01-20

### 初始版本
- ✅ 读取Excel格式的EBS定义书
- ✅ 基于字段相似度计算IF之间的关联性
- ✅ 使用Union-Find算法识别需要合并的IF组
- ✅ 生成格式化的Excel分组结果报告
- ✅ 命令行接口支持自定义参数
